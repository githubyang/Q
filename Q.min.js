/* Q.js 轻量级前端开发框架 提供基于dom 事件 模块加载 队列执行等方法 v1.0 项目托管地址: http://github.com/githubyang/Q */
!function(a){({config:{auto:!0,coreLib:[],model:{}},selector:null,Reg:{},uid:0,count:0,map:{},rmap:{},jsReference:{},reference:{},cssArr:{},loaded:{},loadList:{},cacheNode:null,cdp:null,cacheData:{},uuid:null,expando:null,version:"1.0.0",attribute:["class","id","style","title"],class2type:{},toString:Object.prototype.toString,hasOwn:Object.prototype.hasOwnProperty,init:function(){var b=this;this.uuid=0,this.expando="Q"+(Math.random()+"").slice(-8),function(){var a=function(a){var c=a.getElementsByTagName("script"),d=parseInt(c.length-1,10);return b.jsReference[0]=c[d],c[d]}(document);b.reference[0]=document.body.firstChild,function(a){var c=a,d=c.getAttribute("auto"),e=c.getAttribute("core");d&&(b.config.auto="false"===d.toLowerCase()?!1:!0),e&&(b.config.coreLib=e.split(","))}(a||{})}(),document.getElementsByClassName&&(b.selector=1),document.compareDocumentPosition&&(b.cdp=1),a.Q=function(){return b.method()}()},getMod:function(a){var b,c=this.config.model;return b="string"==typeof a?c[a]?c[a]:{path:a}:a},load:function(a,b,c,d){var e,f,g=this,h=function(){g.loaded[a]=1,d()};"string"==typeof a?f=b||a.toLowerCase().split(/\./).pop().replace(/[\?#].*/,""):(a=a.join(""),f=b||a.toLowerCase().split(/\./).pop().replace(/[\?#].*/,"")),"js"===f?(e=document.createElement("script"),e.setAttribute("src",a),e.setAttribute("async",!0)):"css"===f&&(e=document.createElement("link"),e.setAttribute("href",a),e.setAttribute("type","text/css"),e.setAttribute("rel","stylesheet")),c&&(e.charset=c),e.onerror=function(){h(),e.onerror=null},e.onload=e.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(h(),e.onload=e.onreadystatechange=null)},g.jsReference[0].parentNode.insertBefore(e,g.jsReference[0])},check:function(a,b){var c=a.join(""),d=this.getMod(c),e=this,f=(d.path,function(){e.loadList[c]=1,b()});d.requires?this.check(d.requires,function(a){return function(){e.load(a.path,a.type,a.charset,f)}}(d)):this.load(d.path,d.type,d.charset,f)},indexOf:Array.prototype.indexOf||function(a){for(var b=0,c=this.length;c>b;++b)if(this[b]===a)return b;return-1},release:function(a,b){var c,d,e,f,g,h,i,j;for(c=this.map,this.rmap,d=function(a,b){setTimeout(function(){a.call(b)},0)},e=0,f=b.length;f>e;++e)g=b[e],h=c[g],i=h.waiting,j=this.indexOf.call(i,a),i.splice(j,1),0===i.length&&(d(h.callback,h.thisObj),delete c[g])},classArray:function(a){var d,b=function(a){try{return Array.prototype.slice.call(a)}catch(b){for(var c=[],d=0,e=a.length;e>d;d++)c[d]=a[d];return c}},c=b(a);for(d in Q)c[d]=Q[d];return c},isFunction:function(a){return"function"===this.type(a)},isArray:Array.isArray||function(a){return"array"===this.type(a)},isWindow:function(a){return a&&"object"==typeof a&&"setInterval"in a},isNaN:function(a){var b=/\d/;return null===a||!b.test(a)||isNaN(a)},type:function(a){return null===a?String(a):this.class2type[this.toString.call(a)]||"object"},each:function(a,b,c){var d,e=0,f=a.length,g=void 0===f||this.isFunction(a);if(c)if(g){for(d in a)if(b.apply(a[d],c)===!1)break}else for(;f>e&&b.apply(a[e++],c)!==!1;);else if(g){for(d in a)if(b.call(a[d],d,a[d])===!1)break}else for(;f>e&&b.call(a[e],e,a[e++])!==!1;);return a},trim:function(a){return null===a?"":a.toString().replace(/^\s+/,"").replace(/\s+$/,"")},data:function(b,c,d){var e=b===a?0:9===b.nodeType?1:b[this.expando]?b[this.expando]:b[this.expando]=++this.uuid,f=this.cacheData[e]?this.cacheData[e]:this.cacheData[e]={};return void 0!==d&&(f[c]=d),f[c]},removeData:function(b,c){var d=b===a?0:9===b.nodeType?1:b[this.expando],e=function(a){var b;for(b in a)return!1;return!0},f=function(a){if(!(1>d))try{delete a[this.expando]}catch(b){a.removeAttribute(this.expando)}};void 0!==d&&(delete this.cacheData[d][c],e(this.cacheData[d])&&f(b))},addEvent:function(a,b,c){a["on"+b]=c},removeEvent:function(a,b){a["on"+b]=null,this.removeData(a,b)},fixEvent:function(a){var b,c,d,e;if(a.target)return a;c={},c.target=a.srcElement||document,c.preventDefault=function(){a.returnValue=!1},c.stopPropagation=function(){a.cancelBubble=!0};for(b in a)c[b]=a[b];return c.pageX!==!0&&null!==c.clientX&&(d=document.documentElement,e=document.body,c.pageX=c.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),c.pageY=c.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),c},handler:function(b){var c=this;return function(d){d=c.fixEvent(d||a.event);for(var e,f=d.type,g=0,h=c.data(b,f),i=h.length;i>g;g++)e=h[g],e.call(b,d)===!1&&(d.preventDefault(),d.stopPropagation())}},initReady:function(a){document.addEventListener?document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),a()},!1):document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),a())})},className:function(){var a,b,c,d,e=Array.prototype.slice.call(arguments),f=[],g=0,h=e[1]||"*";if(e!==!1){if(this.selector){for(a=document.getElementsByClassName(e[0]),c=a.length;c>g;g++)f.push(a[g]);return f}for(classNmae=e[0].replace("-","\\-"),d=new RegExp("(^|\\s)"+classNmae+"(\\s|$)"),this.cacheNode?a=this.cacheNode:this.cacheNode=a=document.getElementsByTagName(h),c=a.length;c>g;g++)b=a[g],d.test(b.className)&&f.push(b);return f}},attriubte:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(this.Reg.reg?a=this.Reg.reg:(a=/([\*a-zA-Z1-6]*)?(\[(\w+)\s*(\^|\$|\*|\||~|!)?=?\s*([\w\u00C0-\uFFFF\s\-_\.]+)?\])?/,this.Reg.reg=a),f=arguments[1]||document,g=arguments[0],h=g.match(a),i=h[1],j=h[3],k=h[4]+"=",l=h[5],m=[],n=f.getElementsByTagName(i),o=n.length,document.querySelectorAll&&"!="!=k){for(e=document.querySelectorAll(g),c=0,length=e.length;length>c;c++)m.push(e[c]);return m}for(c=0;o>c;c++)b=n[c],e=b[j],"string"==typeof e&&e!==!1&&(p=!1,"*="===k?p=e.indexOf(l)>=0?!0:!1:"!="===k?p=e!=l?!0:!1:"^="===k?p=0===e.indexOf(l)?!0:!1:"$="===k?(d=l.length,p=e.slice(-d)===l?!0:!1):"~="===k?p=(""+e).indexOf(l)>=0?!0:!1:"|="===k?p=e===l||e.slice(0,l.length+1)===l+"-"?!0:!1:"="===k&&(p=e===l?!0:!1),p&&m.push(b));return m},insert:function(a,b,c){var d=document.createDocumentFragment(),e=this.parseTag(b,d);"append"===c?a.appendChild(e):"prepend"===c?a.insertBefore(e,a.firstChild):"before"===c?a.parentNode.insertBefore(e,a):"after"===c&&a.parentNode.insertBefore(e,a.nextSibling)},parseTag:function(a,b){var c,d=document.createElement("div"),e=/^<(\w+)\s*\/?>$/,f=/<\s*([\w\:]+)/;if(e.test(a)===!0)return document.createElement(RegExp.$1);if(f.test(a)===!0){for(d.innerHTML=a;c=d.firstChild;)b.appendChild(c);return b}return c=document.createTextNode(a),b.appendChild(c),b},getStyle:function(b,c){var g,h,i,j,k,d=document.documentMode?5==document.documentMode?!0:!1:"CSS1Compat"==document.compatMode?!1:!0,e=function(a){return a.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()})},f=function(b){var c,d;return(c=b.style.filter.match(a.XDomainRequest?/progid:DXImageTransform.Microsoft.Alpha\(.?opacity=(.*).?\)/i:/alpha\(opacity=(.*)\)/i))&&(d=parseFloat(c[1]),!isNaN(d))?d?d/100:0:1};return document.recalc?"opacity"==c?f(b):(g=b.currentStyle[e(c)],/^(height|width)$/.test(c)?(h="width"==c?["left","right"]:["top","bottom"],d?b[e("offset-"+c)]:(i=parseFloat(b[e("client-"+c)]),j=parseFloat(this.getStyle.call(null,b,"padding-"+h[0])),k=parseFloat(this.getStyle.call(null,b,"padding-"+h[1])),i-j-k)):g):("float"===c&&(c=Float),document.defaultView.getComputedStyle(b,null).getPropertyValue(c))},contains:function(a,b){return 1===this.cdp?!!(16&a.compareDocumentPosition(b)):a!==b&&(a.contains?a.contains(b):!0)},fixMouseLeave:function(b,c){var d=this.cdp?"mouseout":"mouseleave",e=this;return(null===b||b===a)&&(b=document),{type:d,elem:b,fn:this.cdp?function(a){e.contains(a.relatedTarget,this)&&c.call(this,a)}:c}},fixMouseEnter:function(b,c){var d=this.cdp?"mouseover":"mouseenter",e=this;return(null===b||b===a)&&(b=document),{type:d,elem:b,fn:this.cdp?function(a){e.contains(a.relatedTarget,this)&&c.call(this,a)}:c}},method:function(){var b=this;return{run:function(){var a,c,d=[].slice.call(arguments),e=parseInt(d.length,10);return b.uid++,b.config.auto&&b.loadList[b.config.coreLib.join("")]!==!0&&1!=b.uid>1?(b.check(b.config.coreLib,function(){Q.run.apply(b,d)}),Q):e>0&&1!=(1===b.loadList[d[0]])?("function"==typeof d[e-1]&&(a=d.pop()),c=d.join(""),(0===d.length||b.loadList[c])&&a?(a(),Q):(b.check(d,function(){b.loadList[c]=1,a&&a()}),Q)):Q},set:function(a){if(a)for(var c in a)b.config.model[c]=a[c];return Q},inCss:function(a,c){var d=document.getElementById("addCss");return d||(d=document.createElement("style"),d.type="text/css",d.id="addCss",b.reference[0].parentNode.insertBefore(d,b.reference[0])),1!=(b.cssArr[0]===a)&&(b.cssArr[0]=a,d.styleSheet?d.styleSheet.cssText=d.styleSheet.cssText+c:d.appendChild(document.createTextNode(c))),Q},add:function(a,c){return a&&c&&c.path?(b.config.model[a]=c,Q):void 0},when:function(c,d,e){var h,i,j,k,l,f=b.map,g=b.rmap;for("string"==typeof c&&(c=[c]),h=(b.count++).toString(16),f[h]={waiting:c.slice(0),callback:d,thisObj:e||a},i=0,j=c.length;j>i;++i)k=c[i],l=g[k]||(g[k]=[]),l.push(h);return Q},trigger:function(a){var c,d,e,f;if(!a)return Q;for(b.map,c=b.rmap,"string"==typeof a&&(a=[a]),d=0,e=a.length;e>d;++d)f=a[d],"undefined"!=typeof c[f]&&(b.release(f,c[f]),delete c[f]);return Q},$:function(a){var c,d,e=/(^[\.|#]{1}\w+)+\s*>\s*(\.*\w+)+$/,f=/^#\w+$/,g=/^\.\w+$/;return"object"==typeof a||1===a.nodeType||9===a.nodeType?(a==document&&(a=document.body),b.classArray([a])):f.test(a)?(c=document.getElementById(a.replace("#","")),b.classArray([c])):g.test(a)?(c=b.className(a.replace(".","")),b.classArray(c)):e.test(a)?(d=a.match(e),c=Q.$(d[1]).children().find(d[2])):(c=b.attriubte(a),b.classArray(c))},bind:function(a,c){var f,d=this[0],e=b.data(d,a)||b.data(d,a,[]);e.push(c),1===e.length&&(f=b.handler(d),b.addEvent(d,a,f))},unbind:function(a){var c=this[0],d=b.data(c,a);void 0!==d&&b.removeEvent(c,a)},ready:function(a){b.initReady(a)},remove:function(a){var b=function(a){var b,c=a;document.recalc?"body"!=(c[0]&&c[0].tagName)&&(b=document.createElement("div"),b.appendChild(c[0]),b.innerHTML=""):"body"!=(c[0]&&c[0].parentNode&&c[0].tagName)&&c[0].parentNode.removeChild(c[0])};b(a?a:this)},addClass:function(a){var c,d,e=a.split(" "),f=e.length,g=0;if(1===this[0].nodeType){if(this[0].className){if(c=" "+this[0].className+" ",d=this[0].className,f>0)for(;f>g;g++)c.indexOf(" "+e[g]+" ")<0&&(d+=" "+e[g]);else d+=" "+a;this[0].className=b.trim(d)}else this[0].className=a;return this}},removeClass:function(a){var c,d,e,f,g,h,i;if(void 0!==a){if(c=this[0].className)if(g=b.trim(c.replace(/\s{2,}/," ")).split(" "),h=g.length,i=0,h>1){for(;h>i;i++)d=b.indexOf.call(g,g[i]),-1!=d&&g.splice(d,1);e=g.join(" "),this[0].className=b.trim(e)}else f=b.trim(a),d=b.indexOf.call(g,f),-1!=d&&(this[0].className="")}else this[0].className="";return this},attr:function(a,c){if(void 0!==c)return this[0].setAttribute(a,c),this;var d,e=b.indexOf.call(b.attribute,a);return-1===e?(d=this[0].getAttribute(a)||this[0].attributes[a],d||(d=this[0].getAttributeNode(a)?this[0].getAttributeNode(a).value:""),d):d=a&&"class"==a&&this[0].className?this[0].className:this[0][a]},append:function(a){void 0!==a&&b.insert(this[0],a,"append")},prepend:function(a){void 0!==a&&b.insert(this[0],a,"prepend")},before:function(a){void 0!==a&&b.insert(this[0],a,"before")},after:function(a){void 0!==a&&b.insert(this[0],a,"after")},html:function(a){return void 0===a?this[0].innerHTML:(this[0].innerHTML=a,this)},val:function(a){return void 0===a?this[0].textContent?this[0].textContent:this[0].innerText:this[0].value},css:function(a){return void 0!==a?b.getStyle(this[0],a):void 0},children:function(){for(var a=this[0].childNodes,c=0,d=a.length,e=[];d>c;c++)1===a[c].nodeType&&e.push(a[c]);return b.classArray(e)},find:function(a){for(var c,d=this,e=d.length,f=0,g=[],h=a;e>f;f++)0===a.indexOf(".")?(h=0===a.indexOf(".")?a.slice(1):a,c=Q.$(d[f]).attr("class")):c=d[f].tagName.toLowerCase(),h===c&&g.push(d[f]);return b.classArray(g)},bound:function(a){var b;return b=a?a:this[0],b.getBoundingClientRect()},x:function(){var a=Q.bound(this[0]).left+document.documentElement.scrollLeft-document.documentElement.clientLeft;return a},y:function(){var a=Q.bound(this[0]).top+document.documentElement.scrollTop-document.documentElement.clientTop;return a},hover:function(a,c){var d=b.fixMouseLeave(this[0],a),e=b.fixMouseEnter(this[0],c);this.bind(d.type,d.fn),this.bind(e.type,e.fn)},each:function(a,c){return b.each(this,a,c)}}}}).init()}(window);